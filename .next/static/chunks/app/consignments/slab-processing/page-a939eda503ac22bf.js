(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[874],{8608:function(e,s,t){Promise.resolve().then(t.bind(t,3942))},3942:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f}});var a=t(7437),l=t(2265),r=t(5306),n=t(6013),c=t(3102),i=t(495),d=t(3138),o=t(2513),m=t(7524),x=t(4863),h=t(3409),u=t(3225),p=t(4817),g=t(883);function f(){let{showToast:e}=(0,d.p)(),[s,t]=(0,l.useState)(!0),[f,b]=(0,l.useState)(!1),[j,y]=(0,l.useState)([]),[N,v]=(0,l.useState)([]),[k,w]=(0,l.useState)(""),[_,S]=(0,l.useState)("all"),[C,Z]=(0,l.useState)({block_id:"",part_name:"",slabs_count:"",sqft:"",thickness:"20"});(0,l.useEffect)(()=>{P()},[]);let P=async()=>{try{t(!0);let[e,s]=await Promise.all([fetch("/api/available-blocks"),fetch("/api/slab-processing")]);if(e.ok){let s=await e.json();y(s)}if(s.ok){let e=await s.json();v(e)}}catch(s){console.error("Error loading data:",s),e("error","Failed to load data")}finally{t(!1)}},q=async()=>{if(!C.block_id||!C.part_name||!C.slabs_count||!C.sqft){e("error","Please fill in all required fields");return}let s=parseInt(C.slabs_count),t=parseFloat(C.sqft),a=parseFloat(C.thickness);if(s<=0||t<=0||a<=0){e("error","Please enter valid positive numbers");return}try{let l=await fetch("/api/slab-processing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({block_id:C.block_id,part_name:C.part_name,slabs_count:s,sqft:t,thickness:a})});if(!l.ok){let e=await l.json();throw Error(e.error||"Failed to add slab processing")}await P(),Z({block_id:"",part_name:"",slabs_count:"",sqft:"",thickness:"20"}),b(!1),e("success","Slab processing added successfully!")}catch(s){console.error("Error adding slab processing:",s),e("error",s instanceof Error?s.message:"Failed to add slab processing")}},E=async s=>{if(confirm("Are you sure you want to delete this slab processing record?"))try{let t=await fetch("/api/slab-processing?id=".concat(s),{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to delete slab processing")}await P(),e("success","Slab processing deleted successfully!")}catch(s){console.error("Error deleting slab processing:",s),e("error",s instanceof Error?s.message:"Failed to delete slab processing")}},T={totalBlocks:j.length,processedParts:N.length,totalSlabs:N.reduce((e,s)=>e+s.slabs_count,0),totalSqft:N.reduce((e,s)=>e+s.sqft,0)},M=Array.from(new Set(j.map(e=>e.granite_consignments.consignment_number))),F=N.filter(e=>{let s=e.granite_blocks.block_no.toLowerCase().includes(k.toLowerCase())||e.part_name.toLowerCase().includes(k.toLowerCase()),t="all"===_||j.find(s=>s.id===e.block_id&&s.granite_consignments.consignment_number===_);return s&&t}),B=j.find(e=>e.id===C.block_id);return s?(0,a.jsx)(r.L,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"text-lg text-gray-600",children:"Loading slab processing data..."})})}):(0,a.jsx)(r.L,{children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Slab Processing"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Process raw granite blocks into slabs"})]}),(0,a.jsxs)(i.z,{onClick:()=>b(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Process New Slab"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(n.Zb,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Available Blocks"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:T.totalBlocks})]}),(0,a.jsx)(m.Z,{className:"w-8 h-8 text-blue-600"})]})}),(0,a.jsx)(n.Zb,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Processed Parts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:T.processedParts})]}),(0,a.jsx)(x.Z,{className:"w-8 h-8 text-green-600"})]})}),(0,a.jsx)(n.Zb,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Slabs"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:T.totalSlabs})]}),(0,a.jsx)(h.Z,{className:"w-8 h-8 text-purple-600"})]})}),(0,a.jsx)(n.Zb,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Sq Ft"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:T.totalSqft.toFixed(1)})]}),(0,a.jsx)(u.Z,{className:"w-8 h-8 text-orange-600"})]})})]}),f&&(0,a.jsxs)(n.Zb,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Process New Slab"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Block"}),(0,a.jsxs)("select",{value:C.block_id,onChange:e=>Z({...C,block_id:e.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm p-2",children:[(0,a.jsx)("option",{value:"",children:"Select a block"}),j.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.block_no," - ",e.granite_consignments.granite_suppliers.name]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Part Name"}),(0,a.jsxs)("select",{value:C.part_name,onChange:e=>Z({...C,part_name:e.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm p-2",children:[(0,a.jsx)("option",{value:"",children:"Select part"}),["A","B","C","D"].map(e=>(0,a.jsxs)("option",{value:e,children:["Part ",e]},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Slabs"}),(0,a.jsx)(c.I,{type:"number",min:"1",value:C.slabs_count,onChange:e=>Z({...C,slabs_count:e.target.value}),placeholder:"85"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Sq Ft"}),(0,a.jsx)(c.I,{type:"number",step:"0.1",min:"0",value:C.sqft,onChange:e=>Z({...C,sqft:e.target.value}),placeholder:"450.5"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thickness (mm)"}),(0,a.jsx)(c.I,{type:"number",min:"1",value:C.thickness,onChange:e=>Z({...C,thickness:e.target.value}),placeholder:"20"})]})]}),B&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Selected Block Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Block No:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:B.block_no})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Consignment:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:B.granite_consignments.consignment_number})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Supplier:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:B.granite_consignments.granite_suppliers.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Gross Measurement:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[B.gross_measurement,"m"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Net Measurement:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[B.net_measurement,"m"]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,a.jsx)(i.z,{onClick:q,children:"Add Slab Processing"}),(0,a.jsx)(i.z,{variant:"outline",onClick:()=>b(!1),children:"Cancel"})]})]}),(0,a.jsx)(n.Zb,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)(c.I,{placeholder:"Search by block number or part name...",value:k,onChange:e=>w(e.target.value),className:"pl-10"})]})}),(0,a.jsx)("div",{className:"sm:w-64",children:(0,a.jsxs)("select",{value:_,onChange:e=>S(e.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm p-2",children:[(0,a.jsx)("option",{value:"all",children:"All Consignments"}),M.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})})]})}),(0,a.jsxs)(n.Zb,{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Slab Processing Records"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Block No"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Part"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slabs Count"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sq Ft"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thickness"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===F.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No slab processing records found"})}):F.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.granite_blocks.block_no})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Part ",e.part_name]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:e.slabs_count}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:[e.sqft.toFixed(1)," sq ft"]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:[e.thickness,"mm"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-900",children:(0,a.jsx)(g.Z,{className:"w-4 h-4"})})})})]},e.id))})]})})]})]})})}},3138:function(e,s,t){"use strict";t.d(s,{ToastProvider:function(){return x},p:function(){return o}});var a=t(7437),l=t(2265),r=t(8030);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r.Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),c=(0,r.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var i=t(4697);let d=l.createContext(void 0),o=()=>{let e=l.useContext(d);if(!e)throw Error("useToast must be used within a ToastProvider");return e},m=e=>{let{id:s,type:t,message:r,onClose:d}=e;return(0,l.useEffect)(()=>{let e=setTimeout(()=>{d(s)},5e3);return()=>clearTimeout(e)},[s,d]),(0,a.jsxs)("div",{className:"\n      flex items-center p-4 mb-3 rounded-lg shadow-lg max-w-sm \n      transform transition-all duration-300 ease-in-out\n      ".concat("success"===t?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800","\n    "),children:[(0,a.jsx)("div",{className:"flex-shrink-0 mr-3",children:"success"===t?(0,a.jsx)(n,{className:"h-5 w-5 text-green-400"}):(0,a.jsx)(c,{className:"h-5 w-5 text-red-400"})}),(0,a.jsx)("div",{className:"flex-1 text-sm font-medium",children:r}),(0,a.jsx)("button",{onClick:()=>d(s),className:"\n          ml-2 inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2\n          ".concat("success"===t?"text-green-500 hover:bg-green-100 focus:ring-green-600":"text-red-500 hover:bg-red-100 focus:ring-red-600","\n        "),children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})]})},x=e=>{let{children:s}=e,[t,r]=(0,l.useState)([]),n=e=>{r(s=>s.filter(s=>s.id!==e))};return(0,a.jsxs)(d.Provider,{value:{showToast:(e,s)=>{let t=Math.random().toString(36).substring(2,9);r(a=>[...a,{id:t,type:e,message:s}])}},children:[s,(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(e=>(0,a.jsx)(m,{id:e.id,type:e.type,message:e.message,onClose:n},e.id))})]})}},3409:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(8030).Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},2513:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(8030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4817:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(8030).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},883:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(8030).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3225:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(8030).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},4697:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(8030).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[998,787,971,23,744],function(){return e(e.s=8608)}),_N_E=e.O()}]);