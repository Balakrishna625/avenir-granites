(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{2414:function(e,t,s){Promise.resolve().then(s.bind(s,7951))},7951:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var a=s(7437),n=s(2265),r=s(6463),l=s(6013),i=s(495),o=s(3102),c=s(3138),d=s(5137),m=s(4232),u=s(7138),p=s(5306);function x(){let e=(0,r.useRouter)(),{showToast:t}=(0,c.p)(),[s,x]=(0,n.useState)(!1),[g,h]=(0,n.useState)([]),[f,b]=(0,n.useState)({consignment_number:"",supplier_id:"",arrival_date:"",payment_cash:"",payment_upi:"",transport_cost:"",notes:""});(0,n.useEffect)(()=>{y();let e=new Date().toISOString().slice(2,10).replace(/-/g,""),t="CON-".concat(e,"-").concat(Math.floor(1e3*Math.random()).toString().padStart(3,"0"));b(e=>({...e,consignment_number:t}))},[]);let y=async()=>{try{let e=await fetch("/api/granite-suppliers");if(e.ok){let t=await e.json();if(t&&t.length>0){h(t);return}}console.warn("No suppliers found or API failed, using fallback data"),h([{id:"supplier-1",name:"Rising Sun Exports",contact_person:"Manager"},{id:"supplier-2",name:"Bargandy Quarry",contact_person:"Sales Head"},{id:"supplier-3",name:"Local Granite Quarry",contact_person:"Owner"}])}catch(e){console.error("Error loading suppliers:",e),h([{id:"supplier-1",name:"Rising Sun Exports",contact_person:"Manager"},{id:"supplier-2",name:"Bargandy Quarry",contact_person:"Sales Head"},{id:"supplier-3",name:"Local Granite Quarry",contact_person:"Owner"}])}},j=async s=>{if(s.preventDefault(),!f.consignment_number||!f.supplier_id||!f.arrival_date){t("error","Please fill in all required fields");return}x(!0);try{console.log("Submitting form data:",f);let s=await fetch("/api/granite-consignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to create consignment");let n=parseFloat(f.payment_cash||"0"),r=parseFloat(f.payment_upi||"0"),l=parseFloat(f.transport_cost||"0");t("success","Consignment created successfully! (Total: ₹".concat((n+r+l).toLocaleString(),")")),e.push("/consignments/".concat(a.id))}catch(e){console.error("Error creating consignment:",e),t("error",e instanceof Error?e.message:"Failed to create consignment. Please try again.")}finally{x(!1)}},v=parseFloat(f.payment_cash||"0")+parseFloat(f.payment_upi||"0")+parseFloat(f.transport_cost||"0");return(0,a.jsx)(p.L,{children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(u.default,{href:"/consignments",children:(0,a.jsxs)(i.z,{variant:"outline",size:"sm",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Back"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"New Consignment"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create a new granite consignment"})]})]}),(0,a.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,a.jsxs)(l.Zb,{className:"p-6",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5"}),"Consignment Details"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Consignment Number *"}),(0,a.jsx)(o.I,{value:f.consignment_number,onChange:e=>b({...f,consignment_number:e.target.value}),placeholder:"CON-241005-001",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),(0,a.jsxs)("select",{value:f.supplier_id,onChange:e=>b({...f,supplier_id:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 bg-white",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select Supplier"}),g.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.contact_person,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Arrival Date *"}),(0,a.jsx)(o.I,{type:"date",value:f.arrival_date,onChange:e=>b({...f,arrival_date:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsx)(o.I,{value:"ACTIVE",disabled:!0,className:"bg-gray-50"})]})]})]}),(0,a.jsxs)(l.Zb,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cash Payment (₹)"}),(0,a.jsx)(o.I,{type:"number",step:"0.01",value:f.payment_cash,onChange:e=>b({...f,payment_cash:e.target.value}),placeholder:"50000"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"UPI Payment (₹)"}),(0,a.jsx)(o.I,{type:"number",step:"0.01",value:f.payment_upi,onChange:e=>b({...f,payment_upi:e.target.value}),placeholder:"25000"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transport Cost (₹)"}),(0,a.jsx)(o.I,{type:"number",step:"0.01",value:f.transport_cost,onChange:e=>b({...f,transport_cost:e.target.value}),placeholder:"5000"})]})]}),(0,a.jsx)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-lg font-medium text-gray-900",children:"Total Expenditure:"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:["₹",v.toLocaleString()]})]})})]}),(0,a.jsxs)(l.Zb,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Information"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),(0,a.jsx)("textarea",{value:f.notes,onChange:e=>b({...f,notes:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 h-24 resize-none",placeholder:"Any additional notes about this consignment..."})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 justify-end",children:[(0,a.jsx)(u.default,{href:"/consignments",children:(0,a.jsx)(i.z,{variant:"outline",type:"button",children:"Cancel"})}),(0,a.jsx)(i.z,{type:"submit",disabled:s,children:s?"Creating...":"Create Consignment"})]})]})]})})}},3138:function(e,t,s){"use strict";s.d(t,{ToastProvider:function(){return u},p:function(){return d}});var a=s(7437),n=s(2265),r=s(8030);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,r.Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),i=(0,r.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var o=s(4697);let c=n.createContext(void 0),d=()=>{let e=n.useContext(c);if(!e)throw Error("useToast must be used within a ToastProvider");return e},m=e=>{let{id:t,type:s,message:r,onClose:c}=e;return(0,n.useEffect)(()=>{let e=setTimeout(()=>{c(t)},5e3);return()=>clearTimeout(e)},[t,c]),(0,a.jsxs)("div",{className:"\n      flex items-center p-4 mb-3 rounded-lg shadow-lg max-w-sm \n      transform transition-all duration-300 ease-in-out\n      ".concat("success"===s?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800","\n    "),children:[(0,a.jsx)("div",{className:"flex-shrink-0 mr-3",children:"success"===s?(0,a.jsx)(l,{className:"h-5 w-5 text-green-400"}):(0,a.jsx)(i,{className:"h-5 w-5 text-red-400"})}),(0,a.jsx)("div",{className:"flex-1 text-sm font-medium",children:r}),(0,a.jsx)("button",{onClick:()=>c(t),className:"\n          ml-2 inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2\n          ".concat("success"===s?"text-green-500 hover:bg-green-100 focus:ring-green-600":"text-red-500 hover:bg-red-100 focus:ring-red-600","\n        "),children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})]})},u=e=>{let{children:t}=e,[s,r]=(0,n.useState)([]),l=e=>{r(t=>t.filter(t=>t.id!==e))};return(0,a.jsxs)(c.Provider,{value:{showToast:(e,t)=>{let s=Math.random().toString(36).substring(2,9);r(a=>[...a,{id:s,type:e,message:t}])}},children:[t,(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:s.map(e=>(0,a.jsx)(m,{id:e.id,type:e.type,message:e.message,onClose:l},e.id))})]})}},5137:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4697:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[998,787,971,23,744],function(){return e(e.s=2414)}),_N_E=e.O()}]);