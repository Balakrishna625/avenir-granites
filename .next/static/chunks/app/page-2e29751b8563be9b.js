(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{67:function(){},2061:function(){},5929:function(e,t,s){Promise.resolve().then(s.bind(s,6114))},6114:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return R}});var a=s(7437),n=s(2265),r=s(5306),l=s(3102),c=s(495),d=s(3409),i=s(8030);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,i.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var x=s(4241),m=s(6273);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,i.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var h=s(6013),p=s(9061),g=s(4697),y=s(6649),f=s(883);let j=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}),N=e=>j.format(e||0);function v(e){let{consignments:t,onAddConsignment:s,onEditConsignment:r,onDeleteConsignment:d,customerId:i,customers:o}=e,[u,j]=(0,n.useState)(null),[v,b]=(0,n.useState)({}),w=e=>{j(e.id),b({total:e.total,rtgs_expected:e.rtgs_expected,cash_expected:e.cash_expected,remarks:e.remarks})},_=()=>{if(u){let e=v.rtgs_expected||0,t=v.cash_expected||0;r(u,{...v,total:e+t}),j(null),b({})}},S=()=>{j(null),b({})};return(0,a.jsx)(h.Zb,{className:"rounded-2xl shadow-sm",children:(0,a.jsxs)(h.aY,{className:"p-0 overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b bg-gray-50",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Consignments (Expected)"}),(0,a.jsxs)("form",{onSubmit:s,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Date"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 border rounded-xl px-3 py-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 text-gray-400"}),(0,a.jsx)(l.I,{name:"c_date",type:"date",className:"border-0 p-0 focus-visible:ring-0 w-full",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Total Amount (₹)"}),(0,a.jsx)(l.I,{name:"c_total",type:"number",placeholder:"Enter total amount",className:"border rounded-xl px-3 py-2 w-full",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"RTGS Expected (₹)"}),(0,a.jsx)(l.I,{name:"c_rtgs",type:"number",placeholder:"RTGS amount",className:"border rounded-xl px-3 py-2 w-full"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Cash Expected (₹)"}),(0,a.jsx)(l.I,{name:"c_cash",type:"number",placeholder:"Cash amount",className:"border rounded-xl px-3 py-2 w-full"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-3 space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Remarks (Optional)"}),(0,a.jsx)(l.I,{name:"c_remarks",type:"text",placeholder:"Enter any remarks",className:"border rounded-xl px-3 py-2 w-full"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"\xa0"}),(0,a.jsxs)(c.z,{className:"rounded-xl w-full",type:"submit",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"})," Add Consignment"]})]})]})]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100 border-b",children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"S.No"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"Total (₹)"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"RTGS Expected (₹)"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"Cash Expected (₹)"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Remarks"}),(0,a.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===t.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:"No consignments found. Add your first consignment using the form above."})}):t.map((e,t)=>{let s=o.find(t=>t.id===e.customer_id),n=u===e.id;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:t+1}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 whitespace-nowrap",children:e.date}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:(null==s?void 0:s.name)||"Unknown"}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 text-right font-medium",children:n?(0,a.jsxs)("div",{className:"w-24 text-right p-2 text-sm bg-gray-100 rounded border-2 border-dashed border-gray-300",children:[N(v.total||0),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Auto-calculated"})]}):N(e.total)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 text-right",children:n?(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(l.I,{type:"number",value:v.rtgs_expected||0,onChange:e=>{let t=parseFloat(e.target.value)||0,s=v.cash_expected||0;b({...v,rtgs_expected:t,total:t+s})},className:"w-24 text-right p-1 text-sm",step:"0.01",min:"0"})}):N(e.rtgs_expected)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 text-right",children:n?(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)(l.I,{type:"number",value:v.cash_expected||0,onChange:e=>{let t=parseFloat(e.target.value)||0,s=v.rtgs_expected||0;b({...v,cash_expected:t,total:s+t})},className:"w-24 text-right p-1 text-sm",step:"0.01",min:"0"})}):N(e.cash_expected)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:n?(0,a.jsx)(l.I,{type:"text",value:v.remarks||"",onChange:e=>b({...v,remarks:e.target.value}),className:"w-32 p-1 text-sm",placeholder:"Remarks"}):e.remarks||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("div",{className:"flex items-center justify-center space-x-2",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:_,className:"text-green-600 hover:text-green-800 p-1 rounded",title:"Save changes",children:(0,a.jsx)(p.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:S,className:"text-gray-600 hover:text-gray-800 p-1 rounded",title:"Cancel editing",children:(0,a.jsx)(g.Z,{className:"w-4 h-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>w(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded",title:"Edit consignment",children:(0,a.jsx)(y.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to delete this consignment?")&&d(e.id)},className:"text-red-600 hover:text-red-800 p-1 rounded",title:"Delete consignment",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})})]})})})]},e.id)})})]})}),t.length>0&&(0,a.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",children:(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:["Total Records: ",t.length]}),(0,a.jsxs)("div",{className:"space-x-6",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:["Total Amount: ",N(t.reduce((e,t)=>e+(t.total||0),0))]}),(0,a.jsxs)("span",{className:"font-medium text-blue-700",children:["RTGS Expected: ",N(t.reduce((e,t)=>e+(t.rtgs_expected||0),0))]}),(0,a.jsxs)("span",{className:"font-medium text-green-700",children:["Cash Expected: ",N(t.reduce((e,t)=>e+(t.cash_expected||0),0))]})]})]})})]})})}let b=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}),w=e=>b.format(e||0);function _(e){let{transactions:t,accounts:s,customers:r,onAddTransaction:d,onEditTransaction:i,onDeleteTransaction:o}=e,[u,j]=(0,n.useState)(null),[N,v]=(0,n.useState)({}),b=e=>{j(e.id),v({amount:e.amount,note:e.note})},_=()=>{if(u){if(0>=(N.amount||0)){alert("Amount must be greater than 0");return}i(u,N),j(null),v({})}},S=()=>{j(null),v({})},k=t.filter(e=>"RTGS"===e.mode),C=t.filter(e=>"CASH"===e.mode);return(0,a.jsx)(h.Zb,{className:"rounded-2xl shadow-sm",children:(0,a.jsxs)(h.aY,{className:"p-0 overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b bg-gray-50",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Payments (Transactions)"}),(0,a.jsxs)("form",{onSubmit:d,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Date"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 border rounded-xl px-3 py-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 text-gray-400"}),(0,a.jsx)(l.I,{name:"t_date",type:"date",className:"border-0 p-0 focus-visible:ring-0 w-full",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Payment Mode"}),(0,a.jsxs)("select",{name:"t_mode",className:"border rounded-xl px-3 py-2 w-full h-10 text-sm",children:[(0,a.jsx)("option",{value:"RTGS",children:"RTGS"}),(0,a.jsx)("option",{value:"CASH",children:"CASH"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Bank Account"}),(0,a.jsx)("select",{name:"t_account",className:"border rounded-xl px-3 py-2 w-full h-10 text-sm",children:s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Amount (₹)"}),(0,a.jsx)(l.I,{name:"t_amount",type:"number",placeholder:"Enter amount",className:"border rounded-xl px-3 py-2 w-full",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Note (Optional)"}),(0,a.jsx)(l.I,{name:"t_note",type:"text",placeholder:"Enter note",className:"border rounded-xl px-3 py-2 w-full"})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(c.z,{className:"rounded-xl",type:"submit",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"})," Add Transaction"]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-0",children:[(0,a.jsxs)("div",{className:"border-r",children:[(0,a.jsxs)("div",{className:"p-4 bg-blue-50 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-800",children:"RTGS Transactions"}),(0,a.jsxs)("p",{className:"text-sm text-blue-600",children:["Total: ",w(k.reduce((e,t)=>e+(t.amount||0),0)),"(",k.length," transactions)"]})]}),(0,a.jsx)("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Customer"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Account"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-900",children:"Amount (₹)"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Note"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-900",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===k.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500 text-sm",children:"No RTGS transactions found"})}):k.map(e=>{let t=r.find(t=>t.id===e.customer_id),n=s.find(t=>t.id===e.account_id),c=u===e.id;return(0,a.jsxs)("tr",{className:"hover:bg-blue-25 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap",children:e.date}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:(null==t?void 0:t.name)||"Unknown"}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:(null==n?void 0:n.name)||"Unknown"}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 text-right font-medium",children:c?(0,a.jsx)(l.I,{type:"number",value:N.amount||0,onChange:e=>v({...N,amount:parseFloat(e.target.value)||0}),className:"w-20 text-right p-1 text-sm",step:"0.01",min:"0"}):w(e.amount)}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:c?(0,a.jsx)(l.I,{type:"text",value:N.note||"",onChange:e=>v({...N,note:e.target.value}),className:"w-24 p-1 text-sm",placeholder:"Note"}):e.note||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:(0,a.jsx)("div",{className:"flex items-center justify-center space-x-1",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:_,className:"text-green-600 hover:text-green-800 p-1 rounded",title:"Save changes",children:(0,a.jsx)(p.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:S,className:"text-gray-600 hover:text-gray-800 p-1 rounded",title:"Cancel editing",children:(0,a.jsx)(g.Z,{className:"w-3 h-3"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>b(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded",title:"Edit transaction",children:(0,a.jsx)(y.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to delete this transaction?")&&o(e.id)},className:"text-red-600 hover:text-red-800 p-1 rounded",title:"Delete transaction",children:(0,a.jsx)(f.Z,{className:"w-3 h-3"})})]})})})]},e.id)})})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"p-4 bg-green-50 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-800",children:"Cash Transactions"}),(0,a.jsxs)("p",{className:"text-sm text-green-600",children:["Total: ",w(C.reduce((e,t)=>e+(t.amount||0),0)),"(",C.length," transactions)"]})]}),(0,a.jsx)("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Customer"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Account"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-900",children:"Amount (₹)"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Note"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-900",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===C.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500 text-sm",children:"No cash transactions found"})}):C.map(e=>{let t=r.find(t=>t.id===e.customer_id),n=s.find(t=>t.id===e.account_id),c=u===e.id;return(0,a.jsxs)("tr",{className:"hover:bg-green-25 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap",children:e.date}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:(null==t?void 0:t.name)||"Unknown"}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:(null==n?void 0:n.name)||"Unknown"}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 text-right font-medium",children:c?(0,a.jsx)(l.I,{type:"number",value:N.amount||0,onChange:e=>v({...N,amount:parseFloat(e.target.value)||0}),className:"w-20 text-right p-1 text-sm",step:"0.01",min:"0"}):w(e.amount)}),(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:c?(0,a.jsx)(l.I,{type:"text",value:N.note||"",onChange:e=>v({...N,note:e.target.value}),className:"w-24 p-1 text-sm",placeholder:"Note"}):e.note||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:(0,a.jsx)("div",{className:"flex items-center justify-center space-x-1",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:_,className:"text-green-600 hover:text-green-800 p-1 rounded",title:"Save changes",children:(0,a.jsx)(p.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:S,className:"text-gray-600 hover:text-gray-800 p-1 rounded",title:"Cancel editing",children:(0,a.jsx)(g.Z,{className:"w-3 h-3"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>b(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded",title:"Edit transaction",children:(0,a.jsx)(y.Z,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to delete this transaction?")&&o(e.id)},className:"text-red-600 hover:text-red-800 p-1 rounded",title:"Delete transaction",children:(0,a.jsx)(f.Z,{className:"w-3 h-3"})})]})})})]},e.id)})})]})})]})]}),t.length>0&&(0,a.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",children:(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:["Total Transactions: ",t.length]}),(0,a.jsxs)("div",{className:"space-x-6",children:[(0,a.jsxs)("span",{className:"font-medium text-blue-700",children:["RTGS Total: ",w(k.reduce((e,t)=>e+(t.amount||0),0))]}),(0,a.jsxs)("span",{className:"font-medium text-green-700",children:["Cash Total: ",w(C.reduce((e,t)=>e+(t.amount||0),0))]}),(0,a.jsxs)("span",{className:"font-bold text-gray-900",children:["Grand Total: ",w(t.reduce((e,t)=>e+(t.amount||0),0))]})]})]})})]})})}var S=s(7800);async function k(){var e,t;if(S&&S.writeFile)return S;if((null===(e=window.XLSX)||void 0===e?void 0:e.writeFile)||(await new Promise((e,t)=>{let s=document.createElement("script");s.src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js",s.async=!0,s.onload=()=>e(),s.onerror=()=>t(Error("Failed to load XLSX from CDN")),document.head.appendChild(s)}),null===(t=window.XLSX)||void 0===t?void 0:t.writeFile))return window.XLSX;throw Error("XLSX not available after dynamic load")}let C=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}),T=e=>C.format(e||0);function R(){var e;let[t,s]=(0,n.useState)("all"),[i,h]=(0,n.useState)(""),[p,g]=(0,n.useState)(""),[y,f]=(0,n.useState)([]),[j,N]=(0,n.useState)([]),[b,w]=(0,n.useState)([]),[S,C]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async function(){let[e,t]=await Promise.all([fetch("/api/customers").then(e=>e.json()),fetch("/api/bank-accounts").then(e=>e.json())]);f(e),N(t)})()},[]),(0,n.useEffect)(()=>{let e=new URLSearchParams;t&&e.set("customerId",t),i&&e.set("from",i),p&&e.set("to",p),fetch("/api/consignments?".concat(e.toString())).then(e=>e.json()).then(w),fetch("/api/transactions?".concat(e.toString())).then(e=>e.json()).then(C)},[t,i,p]);let R=(0,n.useMemo)(()=>{let e=b.reduce((e,t)=>e+(t.total||0),0),t=b.reduce((e,t)=>e+(t.rtgs_expected||0),0),s=b.reduce((e,t)=>e+(t.cash_expected||0),0),a=S.filter(e=>"RTGS"===e.mode).reduce((e,t)=>e+(t.amount||0),0),n=S.filter(e=>"CASH"===e.mode).reduce((e,t)=>e+(t.amount||0),0);return{expectedTotal:e,expectedRTGS:t,expectedCASH:s,receivedRTGS:a,receivedCASH:n,receivedTotal:a+n}},[b,S]),A="all"===t?"All Customers":(null===(e=y.find(e=>e.id===t))||void 0===e?void 0:e.name)||"";async function E(){try{let e=await k(),t=[{Metric:"Expected Total",Value:R.expectedTotal},{Metric:"Expected RTGS",Value:R.expectedRTGS},{Metric:"Expected Cash",Value:R.expectedCASH},{Metric:"Received RTGS",Value:R.receivedRTGS},{Metric:"Received Cash",Value:R.receivedCASH},{Metric:"Total Received",Value:R.receivedTotal},{Metric:"Pending RTGS",Value:Math.max(0,R.expectedRTGS-R.receivedRTGS)},{Metric:"Pending Cash",Value:Math.max(0,R.expectedCASH-R.receivedCASH)},{Metric:"Total Pending",Value:R.expectedTotal-R.receivedTotal}],s=y.map(e=>{let t=b.filter(t=>t.customer_id===e.id),s=S.filter(t=>t.customer_id===e.id),a=t.reduce((e,t)=>e+(t.total||0),0),n=t.reduce((e,t)=>e+(t.rtgs_expected||0),0),r=t.reduce((e,t)=>e+(t.cash_expected||0),0),l=s.filter(e=>"RTGS"===e.mode).reduce((e,t)=>e+(t.amount||0),0),c=s.filter(e=>"CASH"===e.mode).reduce((e,t)=>e+(t.amount||0),0);return{Customer:e.name,Expected_Total:a,Expected_RTGS:n,Expected_Cash:r,Received_RTGS:l,Received_Cash:c,Total_Received:l+c,Pending_RTGS:Math.max(0,n-l),Pending_Cash:Math.max(0,r-c),Total_Pending:a-(l+c),Collection_Rate:a>0?"".concat(((l+c)/a*100).toFixed(1),"%"):"0%"}}).filter(e=>e.Expected_Total>0||e.Total_Received>0),a=b.map((e,t)=>{var s;return{"S.No":t+1,Date:e.date,Customer:(null===(s=y.find(t=>t.id===e.customer_id))||void 0===s?void 0:s.name)||"Unknown","Total (₹)":e.total,"RTGS Expected (₹)":e.rtgs_expected||0,"Cash Expected (₹)":e.cash_expected||0,Remarks:e.remarks||""}}),n=S.filter(e=>"RTGS"===e.mode).map((e,t)=>{var s,a;return{"S.No":t+1,Date:e.date,Customer:(null===(s=y.find(t=>t.id===e.customer_id))||void 0===s?void 0:s.name)||"Unknown",Account:(null===(a=j.find(t=>t.id===e.account_id))||void 0===a?void 0:a.name)||"Unknown","Amount (₹)":e.amount,Note:e.note||""}}),r=S.filter(e=>"CASH"===e.mode).map((e,t)=>{var s,a;return{"S.No":t+1,Date:e.date,Customer:(null===(s=y.find(t=>t.id===e.customer_id))||void 0===s?void 0:s.name)||"Unknown",Account:(null===(a=j.find(t=>t.id===e.account_id))||void 0===a?void 0:a.name)||"Unknown","Amount (₹)":e.amount,Note:e.note||""}}),l=S.map((e,t)=>{var s,a;return{"S.No":t+1,Date:e.date,Customer:(null===(s=y.find(t=>t.id===e.customer_id))||void 0===s?void 0:s.name)||"Unknown",Mode:e.mode,Account:(null===(a=j.find(t=>t.id===e.account_id))||void 0===a?void 0:a.name)||"Unknown","Amount (₹)":e.amount,Note:e.note||""}}),c=y.map(e=>{let t=b.filter(t=>t.customer_id===e.id),s=S.filter(t=>t.customer_id===e.id);return 0===t.length&&0===s.length?null:{Customer:e.name,"Created Date":new Date(e.created_at).toLocaleDateString(),"Total Consignments":t.length,"Total Transactions":s.length,"Last Consignment":t.length>0?Math.max(...t.map(e=>new Date(e.date).getTime())):"None","Last Transaction":s.length>0?Math.max(...s.map(e=>new Date(e.date).getTime())):"None"}}).filter(Boolean),d=e.utils.book_new();e.utils.book_append_sheet(d,e.utils.json_to_sheet(t),"Overall Summary"),e.utils.book_append_sheet(d,e.utils.json_to_sheet(s),"Customer Summary"),e.utils.book_append_sheet(d,e.utils.json_to_sheet(a),"All Consignments"),e.utils.book_append_sheet(d,e.utils.json_to_sheet(l),"All Transactions"),e.utils.book_append_sheet(d,e.utils.json_to_sheet(n),"RTGS Transactions"),e.utils.book_append_sheet(d,e.utils.json_to_sheet(r),"Cash Transactions"),e.utils.book_append_sheet(d,e.utils.json_to_sheet(c),"Customer Details");let i=(A||"all").replace(/[^a-z0-9]+/gi,"_").toLowerCase(),o="granite-ledger-".concat(i,"-").concat(new Date().toISOString().split("T")[0],".xlsx");e.writeFile(d,o),alert("Excel file exported successfully: ".concat(o))}catch(e){console.error(e),alert("Export failed. Ensure internet (for CDN fallback) or bundle 'xlsx'.")}}async function M(e){e.preventDefault();let t=String(new FormData(e.currentTarget).get("new_customer")||"").trim();if(!t)return alert("Customer name is required");let a=await fetch("/api/customers",{method:"POST",body:JSON.stringify({name:t})}),n=await a.json();if(!a.ok)return alert(n.error||"Create failed");f(e=>[n,...e]),s(n.id),e.currentTarget.reset()}async function D(e){var s;e.preventDefault();let a=new FormData(e.currentTarget),n={customer_id:"all"===t?null===(s=y[0])||void 0===s?void 0:s.id:t,date:String(a.get("c_date")||""),total:Number(a.get("c_total")||0),rtgs_expected:Number(a.get("c_rtgs")||0),cash_expected:Number(a.get("c_cash")||0),remarks:String(a.get("c_remarks")||"")};if(!n.customer_id)return alert("Please select/add a customer first.");let r=await fetch("/api/consignments",{method:"POST",body:JSON.stringify(n)}),l=await r.json();if(!r.ok)return alert(l.error||"Create failed");w(e=>[...e,l]),e.currentTarget.reset()}async function Z(e){var s;e.preventDefault();let a=new FormData(e.currentTarget),n={customer_id:"all"===t?null===(s=y[0])||void 0===s?void 0:s.id:t,date:String(a.get("t_date")||""),mode:String(a.get("t_mode")||"RTGS"),account_id:String(a.get("t_account")||""),amount:Number(a.get("t_amount")||0),note:String(a.get("t_note")||"")};if(!n.customer_id)return alert("Please select/add a customer first.");let r=await fetch("/api/transactions",{method:"POST",body:JSON.stringify(n)}),l=await r.json();if(!r.ok)return alert(l.error||"Create failed");C(e=>[...e,l]),e.currentTarget.reset()}async function G(e,t){let s=t.rtgs_expected||0,a=t.cash_expected||0,n=t.total||0;if(Math.abs(n-(s+a))>.01){alert("Validation Error: Total (₹".concat(n.toLocaleString(),") must equal RTGS Expected (₹").concat(s.toLocaleString(),") + Cash Expected (₹").concat(a.toLocaleString(),") = ₹").concat((s+a).toLocaleString()));return}let r={total:n,rtgs_expected:s,cash_expected:a,remarks:t.remarks||""},l=await fetch("/api/consignments/".concat(e),{method:"PUT",body:JSON.stringify(r)}),c=await l.json();if(!l.ok)return alert(c.error||"Update failed");w(t=>t.map(t=>t.id===e?{...t,...r}:t))}async function I(e){if(!confirm("Are you sure you want to delete this consignment?"))return;let t=await fetch("/api/consignments/".concat(e),{method:"DELETE"}),s=await t.json();if(!t.ok)return alert(s.error||"Delete failed");w(t=>t.filter(t=>t.id!==e)),alert("Consignment deleted successfully!")}async function F(e,t){let s={amount:t.amount||0,note:t.note||""},a=await fetch("/api/transactions/".concat(e),{method:"PUT",body:JSON.stringify(s)}),n=await a.json();if(!a.ok)return alert(n.error||"Update failed");C(t=>t.map(t=>t.id===e?{...t,...s}:t))}async function P(e){if(!confirm("Are you sure you want to delete this transaction?"))return;let t=await fetch("/api/transactions/".concat(e),{method:"DELETE"}),s=await t.json();if(!t.ok)return alert(s.error||"Delete failed");C(t=>t.filter(t=>t.id!==e)),alert("Transaction deleted successfully!")}return(0,a.jsx)(r.L,{children:(0,a.jsxs)("div",{className:"min-h-screen w-full bg-gray-50 p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold",children:"Granite Customer Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage consignments and payments with comprehensive table views"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("a",{href:"/analytics",className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-xl transition-colors",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Analytics"]}),(0,a.jsxs)("a",{href:"/admin",className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-xl transition-colors",children:[(0,a.jsx)(o,{className:"w-4 h-4 mr-2"}),"Admin Panel"]})]})]}),(0,a.jsxs)("div",{className:"w-full space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3 items-end",children:[(0,a.jsxs)("select",{className:"border rounded-xl px-3 py-2 md:col-span-4",value:t,onChange:e=>s(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All customers"}),y.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 border rounded-xl px-3 py-2 md:col-span-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),(0,a.jsx)(l.I,{type:"date",className:"border-0 p-0 focus-visible:ring-0 w-full min-w-[160px]",value:i,onChange:e=>h(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 border rounded-xl px-3 py-2 md:col-span-2",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4"}),(0,a.jsx)(l.I,{type:"date",className:"border-0 p-0 focus-visible:ring-0 w-full min-w-[160px]",value:p,onChange:e=>g(e.target.value)})]}),(0,a.jsxs)("form",{onSubmit:M,className:"flex items-stretch gap-2 md:col-span-4 justify-self-end w-full md:w-auto",children:[(0,a.jsx)(l.I,{name:"new_customer",placeholder:"Add customer (unique)",className:"border rounded-xl px-3 py-2 h-11 text-base flex-1 md:w-[260px]"}),(0,a.jsxs)(c.z,{type:"submit",className:"h-11 rounded-2xl shrink-0",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"})," Add"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"px-6 py-2 rounded-full border text-lg font-semibold bg-blue-50 text-blue-700 border-blue-200 shadow-sm",children:A||"Select a customer"}),(0,a.jsxs)(c.z,{type:"button",className:"rounded-2xl pointer-events-auto",variant:"secondary",onClick:E,children:[(0,a.jsx)(u,{className:"w-4 h-4 mr-2"})," Export Excel"]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 uppercase tracking-wide",children:"Expected Total"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:T(R.expectedTotal)})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 uppercase tracking-wide",children:"Expected RTGS"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:T(R.expectedRTGS)})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 uppercase tracking-wide",children:"Expected Cash"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:T(R.expectedCASH)})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,a.jsx)("div",{className:"text-xs text-blue-600 uppercase tracking-wide",children:"Received RTGS"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:T(R.receivedRTGS)})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,a.jsx)("div",{className:"text-xs text-green-600 uppercase tracking-wide",children:"Received Cash"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:T(R.receivedCASH)})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,a.jsx)("div",{className:"text-xs text-amber-600 uppercase tracking-wide",children:"Pending RTGS"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:T(Math.max(0,R.expectedRTGS-R.receivedRTGS))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[(0,a.jsx)("div",{className:"text-xs text-amber-600 uppercase tracking-wide",children:"Pending Cash"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:T(Math.max(0,R.expectedCASH-R.receivedCASH))})]})]}),(0,a.jsx)(v,{consignments:b,onAddConsignment:D,onEditConsignment:G,onDeleteConsignment:I,customerId:t,customers:y}),(0,a.jsx)(_,{transactions:S,accounts:j,customers:y,onAddTransaction:Z,onEditTransaction:F,onDeleteTransaction:P}),(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Granite Ledger - Comprehensive consignment and payment management system"})]})})}},4241:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},3409:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},6273:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},9061:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},6649:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},883:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},4697:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[425,998,787,971,23,744],function(){return e(e.s=5929)}),_N_E=e.O()}]);